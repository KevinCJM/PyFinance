# -*- encoding: utf-8 -*-
"""
@File: A03_ideal_portfolio_api.py
@Modify Time: 2025/9/17 08:05       
@Author: Kevin-Chen
@Descriptions: 根据已有持仓寻找组合配置:  风险不变收益最大,收益不变风险最小,持仓组合变动最小
"""
import json
import numpy as np
import pandas as pd
from scipy.optimize import minimize

from T04_show_plt import plot_efficient_frontier
from T02_other_tools import load_returns_from_excel
from T01_generate_random_weights import compute_perf_arrays, compute_var_parametric_arrays
from T03_weight_limit_cal import hold_weight_limit_cal
from T01_generate_random_weights import generate_weights_random_walk


def analysis_json_and_read_data(json_input, excel_name, sheet_name):
    # json转字典
    params = json.loads(json_input)
    asset_list = params['asset_list']
    draw_plt = params.get('draw_plt', True)
    draw_plt_filename = params.get('draw_plt_filename', None)
    user_holding = params['user_holding']
    ef_data = params['ef_data']
    # 读取excel，生成日收益二维数组
    returns, assets = load_returns_from_excel(excel_name, sheet_name, asset_list)
    return asset_list, draw_plt, draw_plt_filename, user_holding, ef_data, returns


if __name__ == '__main__':
    ''' 准备工作: 模拟json参数输入 ------------------------------------------------------------------------------ '''
    # 字典格式入参
    dict_input = {
        'asset_list': [
            '货币现金类', '固定收益类', '混合策略类', '权益投资类', '另类投资类'
        ],
        'draw_plt': True,  # 是否绘图展示
        'draw_plt_filename': None,  # 绘图保存文件名，None表示不保存直接显示
        'user_holding': {
            'WeightRange': {
                '货币现金类': [0.0, 1.0], '固定收益类': [0.0, 1.0], '混合策略类': [0.0, 0.4],
                '权益投资类': [0.0, 0.7], '另类投资类': [0.0, 0.12]
            },
            'StandardProportion': {
                '货币现金类': 0.1, '固定收益类': 0.2, '混合策略类': 0.2, '权益投资类': 0.4, '另类投资类': 0.1
            },
            'can_sell': {
                '货币现金类': True,
                '固定收益类': False,
                '混合策略类': True,
                '权益投资类': True,
                '另类投资类': True
            },
            'can_buy': {
                '货币现金类': True,
                '固定收益类': True,
                '混合策略类': True,
                '权益投资类': True,
                '另类投资类': True
            }
        },
        'ef_data': {  # 客户持仓的有效前沿
            "weights": [[0.754, 0.222, 0.018, 0.0, 0.006], [0.794, 0.2, 0.004, 0.0, 0.002],
                        [0.748, 0.226, 0.02, 0.0, 0.006], [0.764, 0.211, 0.018, 0.0, 0.007],
                        [0.786, 0.2, 0.013, 0.0, 0.001], [0.8, 0.2, 0.0, 0.0, 0.0],
                        [0.774, 0.202, 0.019, 0.0, 0.005], [0.74, 0.231, 0.024, 0.0, 0.005],
                        [0.781, 0.2, 0.014, 0.0, 0.005], [0.729, 0.244, 0.021, 0.0, 0.006],
                        [0.721, 0.25, 0.026, 0.0, 0.003], [0.712, 0.259, 0.019, 0.0, 0.01],
                        [0.703, 0.267, 0.023, 0.0, 0.007], [0.694, 0.275, 0.027, 0.0, 0.004],
                        [0.685, 0.281, 0.027, 0.0, 0.007], [0.677, 0.289, 0.025, 0.0, 0.009],
                        [0.669, 0.296, 0.03, 0.0, 0.005], [0.66, 0.305, 0.026, 0.0, 0.009],
                        [0.652, 0.312, 0.028, 0.0, 0.008], [0.641, 0.321, 0.028, 0.0, 0.01],
                        [0.632, 0.33, 0.03, 0.0, 0.008], [0.623, 0.337, 0.034, 0.0, 0.006],
                        [0.614, 0.347, 0.033, 0.0, 0.006], [0.605, 0.354, 0.033, 0.0, 0.008],
                        [0.596, 0.361, 0.035, 0.0, 0.008], [0.589, 0.37, 0.032, 0.0, 0.009],
                        [0.58, 0.377, 0.033, 0.0, 0.01], [0.57, 0.385, 0.034, 0.0, 0.011],
                        [0.56, 0.393, 0.037, 0.0, 0.01], [0.552, 0.401, 0.036, 0.0, 0.011],
                        [0.544, 0.409, 0.039, 0.0, 0.008], [0.534, 0.416, 0.039, 0.0, 0.011],
                        [0.524, 0.428, 0.037, 0.0, 0.011], [0.509, 0.44, 0.039, 0.0, 0.012],
                        [0.499, 0.448, 0.044, 0.0, 0.009], [0.49, 0.458, 0.043, 0.0, 0.009],
                        [0.481, 0.464, 0.041, 0.0, 0.014], [0.472, 0.472, 0.041, 0.0, 0.015],
                        [0.464, 0.479, 0.044, 0.0, 0.013], [0.456, 0.488, 0.043, 0.0, 0.013],
                        [0.448, 0.495, 0.046, 0.0, 0.011], [0.439, 0.504, 0.047, 0.0, 0.01],
                        [0.428, 0.512, 0.049, 0.0, 0.011], [0.421, 0.521, 0.045, 0.0, 0.013],
                        [0.409, 0.529, 0.048, 0.0, 0.014], [0.4, 0.536, 0.046, 0.0, 0.018],
                        [0.391, 0.544, 0.05, 0.0, 0.015], [0.384, 0.552, 0.05, 0.0, 0.014],
                        [0.376, 0.56, 0.049, 0.0, 0.015], [0.367, 0.568, 0.051, 0.0, 0.014],
                        [0.357, 0.576, 0.051, 0.0, 0.016], [0.349, 0.583, 0.053, 0.0, 0.015],
                        [0.338, 0.594, 0.052, 0.0, 0.016], [0.33, 0.601, 0.056, 0.0, 0.013],
                        [0.321, 0.606, 0.058, 0.0, 0.015], [0.305, 0.623, 0.054, 0.0, 0.018],
                        [0.296, 0.631, 0.056, 0.0, 0.017], [0.286, 0.641, 0.057, 0.0, 0.016],
                        [0.277, 0.647, 0.06, 0.0, 0.016], [0.268, 0.656, 0.058, 0.0, 0.018],
                        [0.259, 0.663, 0.06, 0.0, 0.018], [0.25, 0.671, 0.061, 0.0, 0.018],
                        [0.243, 0.679, 0.059, 0.0, 0.019], [0.233, 0.685, 0.063, 0.0, 0.019],
                        [0.224, 0.694, 0.061, 0.0, 0.021], [0.215, 0.703, 0.063, 0.0, 0.019],
                        [0.206, 0.711, 0.063, 0.0, 0.02], [0.2, 0.717, 0.064, 0.0, 0.019],
                        [0.187, 0.728, 0.064, 0.0, 0.021], [0.179, 0.736, 0.064, 0.0, 0.021],
                        [0.17, 0.742, 0.068, 0.0, 0.02], [0.162, 0.753, 0.068, 0.0, 0.017],
                        [0.155, 0.758, 0.067, 0.0, 0.02], [0.144, 0.767, 0.068, 0.0, 0.021],
                        [0.126, 0.784, 0.069, 0.0, 0.021], [0.114, 0.79, 0.073, 0.0, 0.023],
                        [0.108, 0.798, 0.07, 0.0, 0.024], [0.101, 0.805, 0.071, 0.0, 0.023],
                        [0.092, 0.814, 0.074, 0.0, 0.02], [0.083, 0.822, 0.073, 0.0, 0.022],
                        [0.075, 0.828, 0.074, 0.0, 0.023], [0.064, 0.839, 0.075, 0.0, 0.022],
                        [0.058, 0.846, 0.074, 0.0, 0.022], [0.046, 0.854, 0.077, 0.0, 0.023],
                        [0.037, 0.861, 0.077, 0.0, 0.025], [0.029, 0.87, 0.079, 0.0, 0.022],
                        [0.019, 0.878, 0.079, 0.0, 0.024], [0.007, 0.888, 0.078, 0.0, 0.027],
                        [0.002, 0.895, 0.079, 0.0, 0.024], [0.0, 0.891, 0.083, 0.0, 0.026],
                        [0.0, 0.882, 0.093, 0.0, 0.025], [0.0, 0.877, 0.093, 0.0, 0.03],
                        [0.0, 0.87, 0.098, 0.0, 0.032], [0.0, 0.863, 0.103, 0.0, 0.034],
                        [0.0, 0.856, 0.107, 0.0, 0.037], [0.0, 0.852, 0.111, 0.0, 0.037],
                        [0.0, 0.846, 0.115, 0.0, 0.039], [0.0, 0.841, 0.118, 0.0, 0.041],
                        [0.0, 0.832, 0.125, 0.0, 0.043], [0.0, 0.824, 0.131, 0.0, 0.045],
                        [0.0, 0.819, 0.133, 0.0, 0.048], [0.0, 0.816, 0.135, 0.0, 0.049],
                        [0.0, 0.811, 0.14, 0.0, 0.049], [0.0, 0.804, 0.148, 0.0, 0.048],
                        [0.0, 0.794, 0.155, 0.0, 0.051], [0.0, 0.79, 0.154, 0.0, 0.056],
                        [0.0, 0.787, 0.157, 0.0, 0.056], [0.0, 0.782, 0.16, 0.0, 0.058],
                        [0.0, 0.773, 0.166, 0.0, 0.061], [0.0, 0.763, 0.174, 0.0, 0.063],
                        [0.0, 0.758, 0.178, 0.0, 0.064], [0.0, 0.754, 0.18, 0.0, 0.066],
                        [0.0, 0.746, 0.186, 0.0, 0.068], [0.0, 0.743, 0.188, 0.0, 0.069],
                        [0.0, 0.731, 0.194, 0.0, 0.075], [0.0, 0.727, 0.199, 0.0, 0.074],
                        [0.0, 0.725, 0.2, 0.0, 0.075], [0.0, 0.713, 0.209, 0.0, 0.078],
                        [0.0, 0.703, 0.216, 0.0, 0.081], [0.0, 0.694, 0.222, 0.0, 0.084],
                        [0.0, 0.687, 0.228, 0.0, 0.085], [0.0, 0.684, 0.229, 0.0, 0.087],
                        [0.0, 0.675, 0.236, 0.0, 0.089], [0.0, 0.671, 0.239, 0.0, 0.09],
                        [0.0, 0.662, 0.245, 0.0, 0.093], [0.0, 0.659, 0.247, 0.0, 0.094],
                        [0.0, 0.654, 0.25, 0.0, 0.096], [0.0, 0.647, 0.256, 0.0, 0.097],
                        [0.0, 0.639, 0.261, 0.0, 0.1], [0.0, 0.634, 0.265, 0.0, 0.101],
                        [0.0, 0.629, 0.268, 0.0, 0.103], [0.0, 0.624, 0.272, 0.0, 0.104],
                        [0.0, 0.618, 0.277, 0.0, 0.105], [0.0, 0.615, 0.278, 0.0, 0.107],
                        [0.0, 0.612, 0.28, 0.0, 0.108], [0.312, 0.615, 0.057, 0.0, 0.016],
                        [0.0, 0.6, 0.289, 0.0, 0.111], [0.0, 0.593, 0.293, 0.0, 0.114],
                        [0.0, 0.588, 0.297, 0.0, 0.115], [0.0, 0.583, 0.3, 0.0, 0.117],
                        [0.0, 0.573, 0.307, 0.0, 0.12], [0.0, 0.62, 0.273, 0.0, 0.107],
                        [0.0, 0.557, 0.323, 0.0, 0.12], [0.0, 0.552, 0.328, 0.0, 0.12],
                        [0.0, 0.543, 0.337, 0.0, 0.12], [0.0, 0.533, 0.347, 0.0, 0.12],
                        [0.0, 0.524, 0.356, 0.0, 0.12], [0.0, 0.51, 0.37, 0.0, 0.12],
                        [0.0, 0.505, 0.375, 0.0, 0.12], [0.0, 0.487, 0.393, 0.0, 0.12],
                        [0.0, 0.483, 0.397, 0.0, 0.12], [0.0, 0.474, 0.4, 0.006, 0.12],
                        [0.0, 0.465, 0.4, 0.015, 0.12], [0.0, 0.454, 0.4, 0.026, 0.12],
                        [0.0, 0.445, 0.4, 0.035, 0.12], [0.0, 0.434, 0.4, 0.046, 0.12],
                        [0.0, 0.425, 0.4, 0.055, 0.12], [0.0, 0.414, 0.4, 0.066, 0.12],
                        [0.0, 0.405, 0.4, 0.075, 0.12], [0.0, 0.394, 0.4, 0.086, 0.12],
                        [0.0, 0.385, 0.4, 0.095, 0.12], [0.0, 0.591, 0.296, 0.0, 0.113],
                        [0.0, 0.374, 0.4, 0.106, 0.12], [0.0, 0.365, 0.4, 0.115, 0.12],
                        [0.0, 0.354, 0.4, 0.126, 0.12], [0.0, 0.345, 0.4, 0.135, 0.12],
                        [0.0, 0.334, 0.4, 0.146, 0.12], [0.0, 0.325, 0.4, 0.155, 0.12],
                        [0.0, 0.314, 0.4, 0.166, 0.12], [0.0, 0.305, 0.4, 0.175, 0.12],
                        [0.0, 0.294, 0.4, 0.186, 0.12], [0.0, 0.285, 0.4, 0.195, 0.12],
                        [0.0, 0.274, 0.4, 0.206, 0.12], [0.0, 0.265, 0.4, 0.215, 0.12],
                        [0.0, 0.254, 0.4, 0.226, 0.12], [0.0, 0.245, 0.4, 0.235, 0.12],
                        [0.0, 0.233, 0.4, 0.247, 0.12], [0.0, 0.225, 0.4, 0.255, 0.12],
                        [0.0, 0.214, 0.4, 0.266, 0.12], [0.0, 0.205, 0.4, 0.275, 0.12],
                        [0.0, 0.2, 0.394, 0.286, 0.12], [0.0, 0.2, 0.385, 0.295, 0.12],
                        [0.0, 0.2, 0.374, 0.306, 0.12], [0.0, 0.2, 0.365, 0.315, 0.12],
                        [0.0, 0.2, 0.354, 0.326, 0.12], [0.0, 0.2, 0.345, 0.335, 0.12],
                        [0.0, 0.2, 0.334, 0.346, 0.12], [0.0, 0.2, 0.325, 0.355, 0.12],
                        [0.0, 0.2, 0.314, 0.366, 0.12], [0.0, 0.2, 0.305, 0.375, 0.12],
                        [0.0, 0.2, 0.294, 0.386, 0.12], [0.0, 0.2, 0.285, 0.395, 0.12],
                        [0.0, 0.2, 0.274, 0.406, 0.12], [0.0, 0.2, 0.265, 0.415, 0.12],
                        [0.0, 0.2, 0.254, 0.426, 0.12], [0.0, 0.2, 0.245, 0.435, 0.12],
                        [0.0, 0.2, 0.234, 0.446, 0.12], [0.0, 0.2, 0.225, 0.455, 0.12],
                        [0.0, 0.2, 0.214, 0.466, 0.12], [0.0, 0.2, 0.205, 0.475, 0.12],
                        [0.0, 0.2, 0.194, 0.486, 0.12], [0.0, 0.2, 0.185, 0.495, 0.12],
                        [0.0, 0.2, 0.174, 0.506, 0.12], [0.0, 0.2, 0.165, 0.515, 0.12],
                        [0.0, 0.2, 0.154, 0.526, 0.12], [0.0, 0.2, 0.145, 0.535, 0.12],
                        [0.0, 0.2, 0.135, 0.545, 0.12], [0.0, 0.2, 0.134, 0.546, 0.12],
                        [0.0, 0.2, 0.125, 0.555, 0.12], [0.0, 0.2, 0.114, 0.566, 0.12],
                        [0.0, 0.2, 0.105, 0.575, 0.12], [0.0, 0.2, 0.104, 0.576, 0.12],
                        [0.0, 0.2, 0.094, 0.586, 0.12], [0.0, 0.2, 0.085, 0.595, 0.12],
                        [0.0, 0.2, 0.074, 0.606, 0.12], [0.0, 0.2, 0.065, 0.615, 0.12],
                        [0.0, 0.2, 0.054, 0.626, 0.12], [0.0, 0.2, 0.045, 0.635, 0.12],
                        [0.0, 0.2, 0.034, 0.646, 0.12], [0.0, 0.2, 0.025, 0.655, 0.12],
                        [0.0, 0.2, 0.014, 0.666, 0.12], [0.0, 0.2, 0.005, 0.675, 0.12],
                        [0.0, 0.773, 0.192, 0.0, 0.035], [0.006, 0.351, 0.398, 0.126, 0.119],
                        [0.133, 0.753, 0.109, 0.0, 0.005], [0.0, 0.2, 0.393, 0.296, 0.111],
                        [0.0, 0.229, 0.394, 0.263, 0.114], [0.0, 0.761, 0.157, 0.0, 0.082],
                        [0.0, 0.698, 0.236, 0.0, 0.066], [0.336, 0.589, 0.065, 0.0, 0.01],
                        [0.0, 0.671, 0.252, 0.0, 0.077], [0.008, 0.361, 0.4, 0.111, 0.12],
                        [0.0, 0.703, 0.238, 0.0, 0.059], [0.0, 0.749, 0.193, 0.0, 0.058],
                        [0.0, 0.2, 0.0, 0.689, 0.111], [0.766, 0.2, 0.034, 0.0, 0.0],
                        [0.495, 0.46, 0.045, 0.0, 0.0], [0.0, 0.509, 0.384, 0.0, 0.107],
                        [0.0, 0.49, 0.395, 0.0, 0.115], [0.0, 0.893, 0.092, 0.0, 0.015],
                        [0.0, 0.875, 0.099, 0.0, 0.026], [0.005, 0.207, 0.003, 0.666, 0.119],
                        [0.0, 0.759, 0.187, 0.0, 0.054], [0.0, 0.688, 0.216, 0.0, 0.096],
                        [0.0, 0.882, 0.098, 0.0, 0.02], [0.713, 0.25, 0.037, 0.0, 0.0],
                        [0.096, 0.814, 0.079, 0.0, 0.011], [0.441, 0.481, 0.058, 0.0, 0.02],
                        [0.117, 0.794, 0.07, 0.002, 0.017], [0.0, 0.62, 0.288, 0.0, 0.092],
                        [0.0, 0.687, 0.237, 0.0, 0.076], [0.008, 0.9, 0.054, 0.0, 0.038],
                        [0.0, 0.833, 0.11, 0.0, 0.057], [0.0, 0.768, 0.161, 0.0, 0.071],
                        [0.067, 0.856, 0.054, 0.0, 0.023], [0.0, 0.68, 0.25, 0.0, 0.07],
                        [0.0, 0.657, 0.274, 0.0, 0.069], [0.23, 0.699, 0.061, 0.0, 0.01],
                        [0.0, 0.708, 0.201, 0.004, 0.087], [0.324, 0.602, 0.061, 0.0, 0.013],
                        [0.0, 0.793, 0.139, 0.0, 0.068], [0.0, 0.275, 0.398, 0.208, 0.119],
                        [0.0, 0.851, 0.101, 0.0, 0.048], [0.069, 0.832, 0.077, 0.0, 0.022],
                        [0.268, 0.624, 0.091, 0.0, 0.017], [0.009, 0.209, 0.399, 0.263, 0.12],
                        [0.165, 0.786, 0.02, 0.0, 0.029], [0.162, 0.72, 0.084, 0.0, 0.034],
                        [0.007, 0.815, 0.133, 0.0, 0.045], [0.0, 0.86, 0.107, 0.0, 0.033],
                        [0.0, 0.619, 0.302, 0.0, 0.079], [0.0, 0.9, 0.092, 0.0, 0.008],
                        [0.246, 0.694, 0.037, 0.0, 0.023], [0.014, 0.391, 0.4, 0.075, 0.12],
                        [0.0, 0.597, 0.305, 0.0, 0.098], [0.001, 0.754, 0.17, 0.0, 0.075],
                        [0.0, 0.698, 0.246, 0.0, 0.056], [0.645, 0.337, 0.018, 0.0, 0.0],
                        [0.654, 0.335, 0.0, 0.0, 0.011], [0.0, 0.634, 0.27, 0.003, 0.093],
                        [0.005, 0.87, 0.09, 0.0, 0.035], [0.686, 0.275, 0.025, 0.0, 0.014],
                        [0.58, 0.377, 0.037, 0.001, 0.005], [0.0, 0.629, 0.261, 0.0, 0.11],
                        [0.0, 0.912, 0.07, 0.0, 0.018], [0.556, 0.4, 0.027, 0.0, 0.017],
                        [0.55, 0.391, 0.045, 0.0, 0.014], [0.555, 0.404, 0.03, 0.0, 0.011],
                        [0.012, 0.433, 0.4, 0.035, 0.12], [0.0, 0.414, 0.381, 0.091, 0.114],
                        [0.003, 0.582, 0.293, 0.005, 0.117], [0.543, 0.414, 0.032, 0.0, 0.011],
                        [0.525, 0.425, 0.044, 0.0, 0.006], [0.003, 0.896, 0.074, 0.0, 0.027],
                        [0.028, 0.885, 0.067, 0.0, 0.02], [0.034, 0.883, 0.058, 0.0, 0.025],
                        [0.0, 0.457, 0.377, 0.047, 0.119], [0.0, 0.454, 0.372, 0.055, 0.119],
                        [0.0, 0.451, 0.382, 0.05, 0.117], [0.342, 0.574, 0.063, 0.0, 0.021],
                        [0.0, 0.498, 0.388, 0.0, 0.114], [0.0, 0.458, 0.393, 0.042, 0.107],
                        [0.354, 0.59, 0.039, 0.0, 0.017], [0.012, 0.863, 0.102, 0.0, 0.023],
                        [0.0, 0.2, 0.123, 0.565, 0.112], [0.007, 0.28, 0.4, 0.194, 0.119],
                        [0.673, 0.298, 0.022, 0.0, 0.007], [0.666, 0.293, 0.031, 0.001, 0.009],
                        [0.0, 0.211, 0.216, 0.455, 0.118], [0.0, 0.219, 0.277, 0.384, 0.12],
                        [0.0, 0.214, 0.28, 0.388, 0.118], [0.0, 0.209, 0.279, 0.395, 0.117],
                        [0.0, 0.597, 0.284, 0.008, 0.111], [0.005, 0.206, 0.064, 0.606, 0.119],
                        [0.113, 0.803, 0.055, 0.0, 0.029], [0.0, 0.607, 0.3, 0.0, 0.093],
                        [0.117, 0.78, 0.072, 0.0, 0.031], [0.008, 0.777, 0.155, 0.002, 0.058],
                        [0.719, 0.244, 0.036, 0.001, 0.0], [0.723, 0.252, 0.011, 0.0, 0.014],
                        [0.591, 0.381, 0.028, 0.0, 0.0], [0.591, 0.397, 0.007, 0.0, 0.005],
                        [0.111, 0.791, 0.089, 0.001, 0.008], [0.016, 0.875, 0.092, 0.0, 0.017],
                        [0.006, 0.75, 0.19, 0.0, 0.054], [0.013, 0.412, 0.388, 0.067, 0.12],
                        [0.002, 0.418, 0.375, 0.085, 0.12], [0.0, 0.425, 0.34, 0.121, 0.114],
                        [0.589, 0.358, 0.039, 0.0, 0.014], [0.585, 0.368, 0.033, 0.0, 0.014],
                        [0.009, 0.451, 0.384, 0.041, 0.115], [0.527, 0.435, 0.029, 0.0, 0.009],
                        [0.317, 0.603, 0.061, 0.0, 0.019], [0.312, 0.605, 0.056, 0.0, 0.027],
                        [0.321, 0.611, 0.048, 0.0, 0.02], [0.0, 0.243, 0.395, 0.246, 0.116],
                        [0.0, 0.54, 0.346, 0.0, 0.114], [0.002, 0.207, 0.157, 0.515, 0.119],
                        [0.007, 0.243, 0.388, 0.244, 0.118], [0.173, 0.717, 0.096, 0.001, 0.013],
                        [0.002, 0.476, 0.391, 0.012, 0.119], [0.0, 0.479, 0.374, 0.028, 0.119],
                        [0.004, 0.694, 0.231, 0.0, 0.071], [0.0, 0.685, 0.244, 0.0, 0.071],
                        [0.028, 0.887, 0.063, 0.0, 0.022], [0.017, 0.839, 0.107, 0.0, 0.037],
                        [0.0, 0.224, 0.389, 0.268, 0.119], [0.002, 0.214, 0.4, 0.265, 0.119],
                        [0.005, 0.351, 0.4, 0.124, 0.12], [0.0, 0.643, 0.272, 0.0, 0.085],
                        [0.0, 0.641, 0.279, 0.002, 0.078], [0.0, 0.653, 0.272, 0.0, 0.075],
                        [0.0, 0.657, 0.266, 0.0, 0.077], [0.0, 0.823, 0.136, 0.0, 0.041],
                        [0.0, 0.728, 0.187, 0.006, 0.079], [0.0, 0.223, 0.393, 0.265, 0.119],
                        [0.0, 0.21, 0.397, 0.276, 0.117], [0.001, 0.282, 0.374, 0.224, 0.119],
                        [0.439, 0.476, 0.069, 0.0, 0.016], [0.0, 0.569, 0.319, 0.0, 0.112],
                        [0.0, 0.551, 0.335, 0.0, 0.114], [0.0, 0.558, 0.328, 0.0, 0.114],
                        [0.0, 0.578, 0.323, 0.0, 0.099], [0.0, 0.633, 0.25, 0.003, 0.114],
                        [0.0, 0.628, 0.25, 0.012, 0.11], [0.0, 0.597, 0.295, 0.0, 0.108],
                        [0.624, 0.347, 0.015, 0.0, 0.014], [0.628, 0.34, 0.024, 0.0, 0.008],
                        [0.634, 0.323, 0.043, 0.0, 0.0], [0.62, 0.328, 0.034, 0.0, 0.018],
                        [0.293, 0.633, 0.052, 0.0, 0.022], [0.3, 0.611, 0.078, 0.0, 0.011],
                        [0.476, 0.446, 0.066, 0.0, 0.012], [0.478, 0.46, 0.05, 0.002, 0.01],
                        [0.476, 0.453, 0.064, 0.0, 0.007], [0.009, 0.777, 0.142, 0.002, 0.07],
                        [0.497, 0.439, 0.057, 0.0, 0.007], [0.5, 0.432, 0.055, 0.0, 0.013],
                        [0.511, 0.433, 0.039, 0.0, 0.017], [0.006, 0.202, 0.298, 0.377, 0.117],
                        [0.007, 0.206, 0.3, 0.367, 0.12], [0.007, 0.806, 0.141, 0.0, 0.046],
                        [0.004, 0.806, 0.133, 0.001, 0.056], [0.0, 0.803, 0.135, 0.0, 0.062],
                        [0.0, 0.796, 0.135, 0.0, 0.069], [0.003, 0.303, 0.388, 0.186, 0.12],
                        [0.008, 0.312, 0.395, 0.165, 0.12], [0.0, 0.606, 0.293, 0.0, 0.101],
                        [0.071, 0.828, 0.075, 0.0, 0.026], [0.072, 0.815, 0.083, 0.0, 0.03],
                        [0.286, 0.643, 0.049, 0.0, 0.022], [0.302, 0.621, 0.065, 0.0, 0.012],
                        [0.751, 0.208, 0.034, 0.0, 0.007], [0.004, 0.493, 0.384, 0.0, 0.119],
                        [0.005, 0.327, 0.393, 0.155, 0.12], [0.0, 0.735, 0.195, 0.0, 0.07],
                        [0.0, 0.745, 0.176, 0.004, 0.075], [0.0, 0.736, 0.189, 0.0, 0.075],
                        [0.008, 0.2, 0.287, 0.386, 0.119], [0.0, 0.215, 0.3, 0.368, 0.117],
                        [0.707, 0.252, 0.03, 0.0, 0.011], [0.0, 0.527, 0.358, 0.002, 0.113],
                        [0.314, 0.611, 0.059, 0.0, 0.016], [0.754, 0.224, 0.022, 0.0, 0.0],
                        [0.0, 0.266, 0.388, 0.226, 0.12], [0.766, 0.216, 0.013, 0.0, 0.005],
                        [0.583, 0.385, 0.032, 0.0, 0.0], [0.566, 0.395, 0.032, 0.0, 0.007],
                        [0.194, 0.722, 0.063, 0.0, 0.021], [0.193, 0.726, 0.066, 0.0, 0.015],
                        [0.0, 0.469, 0.4, 0.019, 0.112], [0.003, 0.472, 0.393, 0.012, 0.12],
                        [0.001, 0.488, 0.384, 0.009, 0.118], [0.225, 0.685, 0.078, 0.0, 0.012],
                        [0.243, 0.671, 0.064, 0.0, 0.022], [0.244, 0.683, 0.05, 0.0, 0.023],
                        [0.259, 0.668, 0.045, 0.0, 0.028], [0.0, 0.707, 0.207, 0.0, 0.086],
                        [0.0, 0.703, 0.214, 0.0, 0.083], [0.0, 0.722, 0.209, 0.0, 0.069],
                        [0.272, 0.656, 0.049, 0.0, 0.023], [0.261, 0.649, 0.064, 0.0, 0.026],
                        [0.268, 0.65, 0.064, 0.0, 0.018], [0.0, 0.208, 0.007, 0.665, 0.12],
                        [0.005, 0.214, 0.014, 0.647, 0.12], [0.0, 0.805, 0.132, 0.0, 0.063],
                        [0.002, 0.601, 0.277, 0.0, 0.12], [0.0, 0.214, 0.374, 0.293, 0.119],
                        [0.003, 0.214, 0.379, 0.284, 0.12], [0.005, 0.609, 0.266, 0.0, 0.12],
                        [0.006, 0.203, 0.4, 0.271, 0.12], [0.25, 0.665, 0.062, 0.0, 0.023],
                        [0.01, 0.787, 0.144, 0.0, 0.059], [0.005, 0.777, 0.136, 0.0, 0.082],
                        [0.057, 0.837, 0.074, 0.001, 0.031], [0.034, 0.849, 0.099, 0.001, 0.017],
                        [0.013, 0.244, 0.4, 0.224, 0.119], [0.429, 0.496, 0.068, 0.0, 0.007],
                        [0.0, 0.545, 0.335, 0.0, 0.12], [0.005, 0.564, 0.314, 0.0, 0.117],
                        [0.008, 0.795, 0.141, 0.0, 0.056], [0.673, 0.303, 0.024, 0.0, 0.0],
                        [0.0, 0.606, 0.279, 0.006, 0.109], [0.001, 0.675, 0.242, 0.0, 0.082],
                        [0.206, 0.703, 0.068, 0.0, 0.023], [0.216, 0.703, 0.067, 0.0, 0.014],
                        [0.215, 0.693, 0.075, 0.0, 0.017], [0.216, 0.689, 0.07, 0.0, 0.025],
                        [0.223, 0.68, 0.07, 0.0, 0.027], [0.003, 0.684, 0.22, 0.0, 0.093],
                        [0.421, 0.512, 0.049, 0.0, 0.018], [0.003, 0.674, 0.231, 0.0, 0.092],
                        [0.006, 0.392, 0.398, 0.086, 0.118], [0.0, 0.363, 0.4, 0.123, 0.114],
                        [0.004, 0.347, 0.393, 0.136, 0.12], [0.0, 0.351, 0.381, 0.148, 0.12],
                        [0.0, 0.395, 0.397, 0.096, 0.112], [0.006, 0.294, 0.4, 0.18, 0.12],
                        [0.0, 0.2, 0.25, 0.435, 0.115], [0.0, 0.66, 0.245, 0.0, 0.095],
                        [0.0, 0.643, 0.263, 0.0, 0.094], [0.0, 0.646, 0.231, 0.015, 0.108],
                        [0.0, 0.637, 0.243, 0.0, 0.12], [0.006, 0.638, 0.246, 0.0, 0.11],
                        [0.001, 0.646, 0.237, 0.0, 0.116], [0.003, 0.689, 0.237, 0.0, 0.071],
                        [0.007, 0.295, 0.4, 0.18, 0.118], [0.014, 0.28, 0.375, 0.211, 0.12],
                        [0.0, 0.214, 0.344, 0.33, 0.112], [0.009, 0.625, 0.269, 0.0, 0.097],
                        [0.243, 0.685, 0.057, 0.001, 0.014], [0.2, 0.73, 0.047, 0.0, 0.023],
                        [0.677, 0.294, 0.025, 0.0, 0.004], [0.678, 0.308, 0.007, 0.0, 0.007],
                        [0.683, 0.287, 0.03, 0.0, 0.0], [0.372, 0.562, 0.036, 0.0, 0.03],
                        [0.0, 0.506, 0.389, 0.0, 0.105], [0.0, 0.521, 0.349, 0.01, 0.12],
                        [0.006, 0.474, 0.358, 0.045, 0.117], [0.613, 0.346, 0.041, 0.0, 0.0],
                        [0.003, 0.203, 0.003, 0.671, 0.12], [0.0, 0.74, 0.201, 0.001, 0.058],
                        [0.0, 0.692, 0.217, 0.0, 0.091], [0.007, 0.883, 0.092, 0.0, 0.018],
                        [0.444, 0.486, 0.056, 0.001, 0.013], [0.125, 0.782, 0.078, 0.0, 0.015],
                        [0.007, 0.901, 0.062, 0.0, 0.03], [0.018, 0.892, 0.063, 0.0, 0.027],
                        [0.018, 0.898, 0.052, 0.0, 0.032], [0.003, 0.883, 0.085, 0.0, 0.029],
                        [0.003, 0.844, 0.104, 0.001, 0.048], [0.007, 0.897, 0.067, 0.0, 0.029],
                        [0.006, 0.321, 0.398, 0.155, 0.12], [0.068, 0.851, 0.066, 0.0, 0.015],
                        [0.064, 0.847, 0.061, 0.0, 0.028], [0.009, 0.449, 0.397, 0.026, 0.119],
                        [0.001, 0.467, 0.391, 0.022, 0.119], [0.005, 0.451, 0.399, 0.025, 0.12],
                        [0.0, 0.458, 0.379, 0.045, 0.118], [0.003, 0.458, 0.372, 0.048, 0.119],
                        [0.0, 0.684, 0.201, 0.002, 0.113], [0.33, 0.589, 0.063, 0.0, 0.018],
                        [0.005, 0.453, 0.384, 0.039, 0.119], [0.0, 0.25, 0.384, 0.25, 0.116],
                        [0.002, 0.254, 0.365, 0.259, 0.12], [0.0, 0.253, 0.37, 0.261, 0.116],
                        [0.068, 0.828, 0.074, 0.0, 0.03], [0.001, 0.207, 0.386, 0.286, 0.12],
                        [0.0, 0.228, 0.375, 0.277, 0.12], [0.22, 0.703, 0.064, 0.0, 0.013],
                        [0.008, 0.825, 0.133, 0.0, 0.034], [0.256, 0.671, 0.047, 0.0, 0.026],
                        [0.0, 0.629, 0.282, 0.0, 0.089], [0.648, 0.321, 0.019, 0.0, 0.012]],
            "ret_annual": [0.01676713302731514, 0.01535007357597351, 0.016942767426371574, 0.016591165214776993,
                           0.015636805444955826, 0.015022218227386475, 0.0162572730332613, 0.017141854390501976,
                           0.016005592420697212, 0.017405686900019646, 0.017505226656794548,
                           0.018002990633249283, 0.01810857094824314, 0.01821402832865715, 0.018600409850478172,
                           0.0188697949051857, 0.018910937011241913, 0.01928568258881569, 0.01944967731833458,
                           0.019824333488941193, 0.019953301176428795, 0.020117193460464478,
                           0.02031058631837368, 0.02063835598528385, 0.020884232595562935, 0.02105414867401123,
                           0.02134089544415474, 0.021651120856404305, 0.02187935821712017, 0.0221076849848032,
                           0.02217221073806286, 0.022581711411476135, 0.022780943661928177,
                           0.023225639015436172, 0.023371927440166473, 0.02356524020433426,
                           0.024033114314079285, 0.024302246049046516, 0.024425188079476357,
                           0.024594997987151146, 0.024717912077903748, 0.024887656792998314,
                           0.025238558650016785, 0.025449328124523163, 0.025841057300567627,
                           0.026250353083014488, 0.02635575644671917, 0.026461241766810417, 0.02668933756649494,
                           0.026876581832766533, 0.027227351441979408, 0.027391167357563972,
                           0.027689475566148758, 0.027771396562457085, 0.028133723884820938,
                           0.02861328050494194, 0.02880045771598816, 0.02899349108338356, 0.029256483539938927,
                           0.02954886108636856, 0.029794326052069664, 0.030022308230400085,
                           0.030209463089704514, 0.030513236299157143, 0.030805518850684166,
                           0.030934298411011696, 0.031203070655465126, 0.03130253031849861, 0.03172323852777481,
                           0.031910307705402374, 0.03213227167725563, 0.03214423730969429, 0.03246551752090454,
                           0.03279848396778107, 0.03323684632778168, 0.03370388224720955, 0.033850058913230896,
                           0.033972859382629395, 0.03406066447496414, 0.03437016159296036, 0.034632954746484756,
                           0.034849245101213455, 0.03497203812003136, 0.035363104194402695,
                           0.035690080374479294, 0.03573698550462723, 0.03608730435371399, 0.036525167524814606,
                           0.03648454323410988, 0.036717645823955536, 0.036833856254816055, 0.03712513670325279,
                           0.03732883557677269, 0.03753243386745453, 0.03777676820755005, 0.037846438586711884,
                           0.03803247958421707, 0.03820107877254486, 0.038439154624938965, 0.03865978866815567,
                           0.03886890783905983, 0.03896184638142586, 0.03904877230525017, 0.03912973776459694,
                           0.039425577968358994, 0.039698418229818344, 0.039750561118125916,
                           0.03991863504052162, 0.040196821093559265, 0.04045158624649048, 0.04057888686656952,
                           0.040729448199272156, 0.04094937816262245, 0.04104195162653923, 0.04149332642555237,
                           0.04152202978730202, 0.04159727320075035, 0.041926559060811996, 0.042221203446388245,
                           0.04249833524227142, 0.042659856379032135, 0.04279274120926857, 0.04302913695573807,
                           0.04313879832625389, 0.043415579944849014, 0.043507736176252365, 0.0436750091612339,
                           0.0438363179564476, 0.044095516204833984, 0.04422205686569214, 0.04438905790448189,
                           0.04451566934585571, 0.044659510254859924, 0.04479191452264786, 0.04488391801714897,
                           0.028385240584611893, 0.045211631804704666, 0.04545312002301216, 0.04557953029870987,
                           0.04574613273143768, 0.04603905230760574, 0.04470563679933548, 0.046314217150211334,
                           0.046400152146816254, 0.0465548038482666, 0.04672655835747719, 0.046881210058927536,
                           0.04712143912911415, 0.047207221388816833, 0.04751581326127052, 0.04758444428443909,
                           0.048000920563936234, 0.04854767024517059, 0.04921414703130722, 0.04975813627243042,
                           0.05042123794555664, 0.050962552428245544, 0.051622409373521805, 0.05216088891029358,
                           0.052817441523075104, 0.05335329473018646, 0.04544727876782417, 0.05400652438402176,
                           0.05453966557979584, 0.05518960580229759, 0.05571993440389633, 0.05636658892035484,
                           0.05689419060945511, 0.05753757059574127, 0.05806240439414978, 0.05870245024561882,
                           0.0592246912419796, 0.05986134335398674, 0.060380980372428894, 0.06101423129439354,
                           0.061531078070402145, 0.062218260020017624, 0.06267517805099487, 0.06330185383558273,
                           0.06381331384181976, 0.06433822959661484, 0.06469970941543579, 0.06514047831296921,
                           0.06550001353025436, 0.06593827158212662, 0.06629601120948792, 0.06673192977905273,
                           0.06708776950836182, 0.06752131879329681, 0.06787524372339249, 0.06830660998821259,
                           0.06865865737199783, 0.06908738613128662, 0.06943750381469727, 0.06986413896083832,
                           0.07021243870258331, 0.07063670456409454, 0.07098285108804703, 0.0714048519730568,
                           0.07174920290708542, 0.07216887921094894, 0.07251119613647461, 0.07292858511209488,
                           0.07326914370059967, 0.07368406653404236, 0.07402268052101135, 0.07439787685871124,
                           0.07443525642156601, 0.07477203756570816, 0.07518238574266434, 0.07551716268062592,
                           0.0755542442202568, 0.07592516392469406, 0.07625802606344223, 0.07666376233100891,
                           0.07699467241764069, 0.07739783078432083, 0.07772695273160934, 0.07812809944152832,
                           0.07845507562160492, 0.07885385304689407, 0.07917895913124084, 0.039138682186603546,
                           0.0549587644636631, 0.03283745422959328, 0.0643758550286293, 0.06269127875566483,
                           0.0412568561732769, 0.04169955104589462, 0.027613060548901558, 0.04261248931288719,
                           0.054116141051054, 0.04132881015539169, 0.04049130156636238, 0.07931672036647797,
                           0.016414884477853775, 0.022956890985369682, 0.04661484807729721, 0.04726305231451988,
                           0.036233171820640564, 0.036996789276599884, 0.07850891351699829, 0.04015526548027992,
                           0.04308748245239258, 0.03662959858775139, 0.017709748819470406, 0.0335291288793087,
                           0.025617066770792007, 0.03335529938340187, 0.044099949300289154, 0.0422954261302948,
                           0.03672365844249725, 0.03899150341749191, 0.040689531713724136, 0.034470658749341965,
                           0.042173195630311966, 0.042530130594968796, 0.030022965744137764,
                           0.042554181069135666, 0.027999157086014748, 0.04013374447822571, 0.05988679826259613,
                           0.03831200674176216, 0.03476725146174431, 0.03006669506430626, 0.06290505081415176,
                           0.031935252249240875, 0.03341461718082428, 0.03853108733892441, 0.03754396364092827,
                           0.043591175228357315, 0.03582455590367317, 0.029988201335072517, 0.05183405056595802,
                           0.0447387620806694, 0.04105386883020401, 0.041293442249298096, 0.018970627337694168,
                           0.019087934866547585, 0.04403091222047806, 0.03724721074104309, 0.018951157107949257,
                           0.021180834621191025, 0.044671494513750076, 0.03602422773838043,
                           0.022207122296094894, 0.02248723991215229, 0.0219324491918087, 0.049477770924568176,
                           0.05245068296790123, 0.04586133733391762, 0.022248486056923866, 0.022587737068533897,
                           0.03654877841472626, 0.035434216260910034, 0.03542844206094742, 0.05003272742033005,
                           0.050429102033376694, 0.050183817744255066, 0.02807987853884697,
                           0.047085728496313095, 0.04931560903787613, 0.027146104723215103, 0.03659382089972496,
                           0.07482010126113892, 0.058946650475263596, 0.01879410445690155, 0.0192948617041111,
                           0.07072505354881287, 0.06792023777961731, 0.068076953291893, 0.06839130073785782,
                           0.0456148125231266, 0.07633321732282639, 0.033762771636247635, 0.044364482164382935,
                           0.03408261016011238, 0.03976817801594734, 0.01761391945183277, 0.017838934436440468,
                           0.020410919561982155, 0.020335683599114418, 0.03323987498879433, 0.03597605600953102,
                           0.04006712883710861, 0.05117509886622429, 0.05228814110159874, 0.05354064330458641,
                           0.021468762308359146, 0.02145753800868988, 0.04935059696435928, 0.022453853860497475,
                           0.028513245284557343, 0.029009535908699036, 0.028250887989997864,
                           0.061851002275943756, 0.04636472463607788, 0.07303847372531891, 0.061571843922138214,
                           0.03220440074801445, 0.048107463866472244, 0.04883386194705963, 0.04180889576673508,
                           0.04212729632854462, 0.035481009632349014, 0.03737952560186386, 0.06317786872386932,
                           0.06314146518707275, 0.054954882711172104, 0.0434199757874012, 0.043259233236312866,
                           0.04284239187836647, 0.04285428673028946, 0.03851427137851715, 0.04197234287858009,
                           0.06307300180196762, 0.06365036964416504, 0.06038840487599373, 0.02562256157398224,
                           0.04578560218214989, 0.04617568850517273, 0.04605540260672569, 0.045106299221515656,
                           0.04489583894610405, 0.04521643742918968, 0.04514243081212044, 0.020228886976838112,
                           0.01994200050830841, 0.0196660328656435, 0.02088870294392109, 0.029092561453580856,
                           0.028740884736180305, 0.024470334872603416, 0.024151334539055824,
                           0.024143308401107788, 0.04021485522389412, 0.023529235273599625,
                           0.023774562403559685, 0.02347084879875183, 0.06756287068128586, 0.06718670576810837,
                           0.038728225976228714, 0.03930172324180603, 0.03971632197499275, 0.04012219235301018,
                           0.0584326833486557, 0.05720904469490051, 0.04470483213663101, 0.03491883724927902,
                           0.035268157720565796, 0.029203951358795166, 0.02852545492351055,
                           0.017175987362861633, 0.04721073806285858, 0.05666051059961319, 0.0412212498486042,
                           0.04142748564481735, 0.04140663519501686, 0.06795025616884232, 0.06723512709140778,
                           0.01837114989757538, 0.0466354638338089, 0.028373366221785545, 0.01648610085248947,
                           0.060815561562776566, 0.016339752823114395, 0.020668335258960724,
                           0.021476007997989655, 0.03154207020998001, 0.031267695128917694,
                           0.048331212252378464, 0.048175711184740067, 0.047771286219358444,
                           0.030553780496120453, 0.03047182597219944, 0.03026222065091133, 0.030115557834506035,
                           0.04235443100333214, 0.042302198708057404, 0.04140589386224747, 0.029589766636490822,
                           0.030284041538834572, 0.02965366654098034, 0.07869217544794083, 0.07774987816810608,
                           0.039722245186567307, 0.04547587037086487, 0.06434983015060425, 0.063909150660038,
                           0.045216236263513565, 0.06344637274742126, 0.03033151663839817, 0.03946501389145851,
                           0.04077557846903801, 0.03558196499943733, 0.035739392042160034, 0.06053932011127472,
                           0.025313550606369972, 0.0465204156935215, 0.04587012901902199, 0.03928558900952339,
                           0.018419617787003517, 0.045291416347026825, 0.0427052266895771, 0.03146539628505707,
                           0.030688868835568428, 0.03102712705731392, 0.03138304129242897, 0.03133595362305641,
                           0.04291336610913277, 0.025811193510890007, 0.04304584488272667, 0.05252907797694206,
                           0.05466959625482559, 0.05556802451610565, 0.056165583431720734, 0.052904367446899414,
                           0.058213669806718826, 0.07000964134931564, 0.04353097826242447, 0.043784040957689285,
                           0.044957395642995834, 0.04493650048971176, 0.04427251219749451, 0.04457945376634598,
                           0.041936133056879044, 0.058076340705156326, 0.059408999979496, 0.06554527580738068,
                           0.043850209563970566, 0.029944676905870438, 0.031238876283168793,
                           0.018577421084046364, 0.01841425895690918, 0.01829029805958271, 0.027431003749370575,
                           0.046585701406002045, 0.04737050458788872, 0.04933350160717964, 0.0201230738312006,
                           0.07887091487646103, 0.04069160670042038, 0.042816102504730225, 0.0362447164952755,
                           0.025165287777781487, 0.033067215234041214, 0.03642071411013603,
                           0.036006271839141846, 0.03610559552907944, 0.03685728460550308, 0.038355983793735504,
                           0.03644971922039986, 0.05672072246670723, 0.034190114587545395, 0.03495454788208008,
                           0.048895299434661865, 0.0487375371158123, 0.0490197129547596, 0.04988889396190643,
                           0.04993768781423569, 0.04393112659454346, 0.028185609728097916, 0.04955268278717995,
                           0.06189834699034691, 0.06228020787239075, 0.06229585036635399, 0.03520456701517105,
                           0.06418395042419434, 0.0635162964463234, 0.030484534800052643, 0.037868086248636246,
                           0.030104082077741623, 0.04382341727614403, 0.019619716331362724],
            "risk_arr": [0.00019966908439528197, 0.0001521096273791045, 0.00020621092699002475,
                         0.00019321309810038656, 0.00016090580902528018, 0.0001459034683648497,
                         0.00018060045840684325, 0.0002139031421393156, 0.00017138931434601545,
                         0.00022358856222126633, 0.000228715012781322, 0.00024666194804012775,
                         0.00024984587798826396, 0.00025489815743640065, 0.0002682991325855255,
                         0.00027841090923175216, 0.0002806716365739703, 0.0002939176047220826,
                         0.00030004949076101184, 0.0003141530032735318, 0.00031896017026156187,
                         0.0003257923817727715, 0.000333132513333112, 0.00034472940023988485,
                         0.0003539901226758957, 0.0003602033539209515, 0.00037084417999722064,
                         0.000382458878448233, 0.0003910500090569258, 0.0003995492297690362,
                         0.00040258621447719634, 0.00041733236867003143, 0.0004248126642778516,
                         0.00044142379192635417, 0.00044750928645953536, 0.0004548274155240506,
                         0.00047175693907774985, 0.0004819663008674979, 0.00048637596773914993,
                         0.0004927382105961442, 0.0004976652562618256, 0.0005044128047302365,
                         0.0005172961391508579, 0.0005248492234386504, 0.0005394424661062658,
                         0.0005552400834858418, 0.0005587321938946843, 0.000562730710953474,
                         0.0005712341517210007, 0.0005783532978966832, 0.0005913934437558055,
                         0.0005975771346129477, 0.0006087258807383478, 0.0006122885388322175,
                         0.0006255186744965613, 0.0006433912785723805, 0.0006503836484625936,
                         0.0006577229360118508, 0.0006676056073047221, 0.0006784463184885681,
                         0.000687659252434969, 0.0006962177576497197, 0.0007032344001345336,
                         0.0007146427524276078, 0.0007257155957631767, 0.000730421394109726,
                         0.0007405105279758573, 0.0007442523492500186, 0.0007600521785207093,
                         0.0007670614868402481, 0.0007753866375423968, 0.0007762733148410916,
                         0.0007879028562456369, 0.0008003758266568184, 0.0008168391650542617,
                         0.0008344512898474932, 0.0008399725193157792, 0.0008444766863249242,
                         0.0008479181560687721, 0.0008593841921538115, 0.0008692413102835417,
                         0.0008773905574344099, 0.0008820256916806102, 0.0008966632303781807,
                         0.0009089873055927455, 0.0009107981459237635, 0.0009238544735126197,
                         0.000940475903917104, 0.0009387831087224185, 0.000947655295021832,
                         0.0009525306522846222, 0.0009647717233747244, 0.0009741057874634862,
                         0.0009839354315772653, 0.000996381277218461, 0.001000049989670515,
                         0.001010118518024683, 0.0010195731883868575, 0.001033446635119617,
                         0.001046826597303152, 0.001059953821823001, 0.0010659204563125968,
                         0.0010715669486671686, 0.0010770709486678243, 0.0010970532894134521,
                         0.0011160109424963593, 0.0011197351850569248, 0.0011318998876959085,
                         0.0011525274021551013, 0.0011719443136826158, 0.001181839732453227,
                         0.001193665899336338, 0.0012112429831176996, 0.0012187390821054578,
                         0.0012561376206576824, 0.0012585044605657458, 0.001264864462427795,
                         0.0012931154342368245, 0.001318906550295651, 0.0013436004519462585,
                         0.0013581803068518639, 0.0013702533906325698, 0.0013919748598709702,
                         0.0014021297683939338, 0.001428017858415842, 0.0014367209514603019,
                         0.0014525910373777151, 0.0014680040767416358, 0.0014930058969184756,
                         0.001505316118709743, 0.0015216412721201777, 0.0015340829268097878,
                         0.0015482991002500057, 0.0015614363364875317, 0.0015706113772466779,
                         0.0006348501774482429, 0.0016035055741667747, 0.0016279735136777163,
                         0.0016408429946750402, 0.0016578990034759045, 0.0016880675684660673,
                         0.0015528996009379625, 0.0017167534679174423, 0.0017258381703868508,
                         0.0017423275858163834, 0.0017608609050512314, 0.001777714234776795,
                         0.0018042654264718294, 0.0018138412851840258, 0.001848711515776813,
                         0.0018565417267382145, 0.0019101726356893778, 0.001984715461730957,
                         0.0020801331847906113, 0.002161349169909954, 0.0022640053648501635,
                         0.0023504754062741995, 0.0024588466621935368, 0.0025494759902358055,
                         0.002662383019924164, 0.0027563287876546383, 0.0016273778164759278,
                         0.0028728677425533533, 0.0029694833792746067, 0.00308896042406559,
                         0.003187739523127675, 0.0033096170518547297, 0.0034101763740181923,
                         0.0035340285394340754, 0.00363606377504766, 0.0037615622859448195,
                         0.003864829195663333, 0.003991708625108004, 0.004096017684787512, 0.004224070813506842,
                         0.004329262301325798, 0.00447007454931736, 0.004564271308481693, 0.0046941908076405525,
                         0.00480080209672451, 0.004917721264064312, 0.005004331935197115, 0.005110559519380331,
                         0.005197771824896336, 0.005304700694978237, 0.0053924513049423695,
                         0.005500005092471838, 0.00558824697509408, 0.0056963651441037655, 0.005785048473626375,
                         0.005893687251955271, 0.0059827701188623905, 0.006091882474720478, 0.00618133507668972,
                         0.006290866062045097, 0.006380656734108925, 0.006490591913461685, 0.006580682937055826,
                         0.006690974812954664, 0.006781348492950201, 0.006891969125717878, 0.00698261521756649,
                         0.007093538995832205, 0.007184420246630907, 0.007295635994523764, 0.007386733312159777,
                         0.007488067261874676, 0.007498209364712238, 0.007589519955217838, 0.007701246067881584,
                         0.00779274757951498, 0.007802922278642654, 0.007904698140919209, 0.007996384985744953,
                         0.008108554407954216, 0.008200402371585369, 0.008312763646245003, 0.008404772728681564,
                         0.008517323061823845, 0.008609489537775517, 0.008722211234271526, 0.008814522065222263,
                         0.0010866121156141162, 0.0030781119130551815, 0.0008122784201987088,
                         0.005004945211112499, 0.004624290857464075, 0.001240318175405264,
                         0.0012768555898219347, 0.0006076613208279014, 0.0013559346552938223,
                         0.0029237326234579086, 0.0012483000755310059, 0.0011762037174776196,
                         0.008956639096140862, 0.00019154779147356749, 0.00044033527956344187,
                         0.0017566232709214091, 0.0018236556788906455, 0.0009318793308921158,
                         0.000959498924203217, 0.008695138618350029, 0.0011509081814438105,
                         0.0013986023841425776, 0.0009454238461330533, 0.00024019440752454102,
                         0.0008317261235788465, 0.0005351048894226551, 0.0008271170663647354,
                         0.0014952924102544785, 0.0013265787856653333, 0.000953047361690551,
                         0.001070583239197731, 0.0011915345676243305, 0.0008646341739222407,
                         0.0013183668488636613, 0.0013538827188313007, 0.0006994997384026647,
                         0.001354457694105804, 0.0006209230632521212, 0.0011501240078359842,
                         0.004006507340818644, 0.0010274965316057205, 0.0008743205689825118,
                         0.000702404067851603, 0.004654041025787592, 0.0007760806474834681,
                         0.0008325875387527049, 0.0010435108561068773, 0.0009845728054642677,
                         0.0014522199053317308, 0.0009216819889843464, 0.0006971479160711169,
                         0.0025444563943892717, 0.0015581402694806457, 0.0012219883501529694,
                         0.0012480368604883552, 0.00029193557566031814, 0.0002931873023044318,
                         0.0014916191576048732, 0.0009718177025206387, 0.00028497999301180243,
                         0.0003693674225360155, 0.0015500166919082403, 0.0009236063342541456,
                         0.0004054773598909378, 0.0004153383488301188, 0.0003932008985430002,
                         0.0021566725336015224, 0.0026441181544214487, 0.0016805576160550117,
                         0.00040498163434676826, 0.00041938971844501793, 0.0009413693915121257,
                         0.0009004862513393164, 0.000900236947927624, 0.0022190632298588753,
                         0.0022849389351904392, 0.0022479568142443895, 0.0006254756590351462,
                         0.0018041965086013079, 0.0021441217977553606, 0.0005890605971217155,
                         0.0009445563773624599, 0.007688252255320549, 0.003847448853775859,
                         0.000275844126008451, 0.00029747202643193305, 0.006555183790624142,
                         0.005831385497003794, 0.005880631506443024, 0.005960458889603615,
                         0.0016537633491680026, 0.008083322085440159, 0.0008383541717194021,
                         0.0015218956395983696, 0.0008515759836882353, 0.0011324535589665174,
                         0.00023989473993424326, 0.0002446843427605927, 0.0003449208743404597,
                         0.00034319525002501905, 0.0008257506997324526, 0.0009212497971020639,
                         0.0011508283205330372, 0.0024377282243222, 0.0025959275662899017, 0.002873779274523258,
                         0.00037741035339422524, 0.0003762221022043377, 0.002152971224859357,
                         0.00041384922224096954, 0.000640176935121417, 0.0006626535905525088,
                         0.0006302217370830476, 0.004432708024978638, 0.0017238804139196873,
                         0.00716377142816782, 0.00439829658716917, 0.000785132753662765, 0.0019347942434251308,
                         0.0020384739618748426, 0.0012900882866233587, 0.0013133848551660776,
                         0.0009021214209496975, 0.0009823364671319723, 0.004689213819801807,
                         0.004678368102759123, 0.003065491560846567, 0.0014304500073194504,
                         0.0014217357384040952, 0.0013795963022857904, 0.0013793316902592778,
                         0.0010382960317656398, 0.0013064267113804817, 0.004662857390940189,
                         0.004795570392161608, 0.004137358162552118, 0.0005355391767807305,
                         0.0016625872813165188, 0.0017034502234309912, 0.0016905863303691149,
                         0.001596297137439251, 0.0015759526286274195, 0.0016184401465579867,
                         0.001596682472154498, 0.00033167932997457683, 0.0003189707640558481,
                         0.0003143996582366526, 0.00036017317324876785, 0.0006621224456466734,
                         0.0006508489605039358, 0.000491512066219002, 0.0004826811491511762,
                         0.000479265145258978, 0.0011687333462759852, 0.0004552217433229089,
                         0.00046368231414817274, 0.00045210716780275106, 0.005783005151897669,
                         0.005675237160176039, 0.0010561106028035283, 0.0010940972715616226,
                         0.0011186982737854123, 0.0011499696411192417, 0.0037332489155232906,
                         0.0035088728182017803, 0.001553502050228417, 0.0008803154341876507,
                         0.0008954892982728779, 0.0006662830128334463, 0.0006411909125745296,
                         0.0002179313887609169, 0.0018236442701891065, 0.0033926749601960182,
                         0.0012334473431110382, 0.0012570602120831609, 0.0012489716755226254,
                         0.005873020738363266, 0.005679946392774582, 0.000262132118223235,
                         0.0017561011482030153, 0.0006344547145999968, 0.00019347842317074537,
                         0.004196597263216972, 0.00018430882482789457, 0.00035390828270465136,
                         0.000377059041056782, 0.0007532663294114172, 0.0007437720196321607,
                         0.001974838087335229, 0.0019440945470705628, 0.0018907686462625861,
                         0.0007182526751421392, 0.0007136926869861782, 0.0007060211501084268,
                         0.0007031469140201807, 0.001331156468950212, 0.0013261233689263463,
                         0.0012492630630731583, 0.0006809806218370795, 0.0007089403225108981,
                         0.0006825297023169696, 0.008694810792803764, 0.008485628291964531,
                         0.0011195881525054574, 0.0016349604120478034, 0.004952042829245329,
                         0.004858868662267923, 0.0016149233561009169, 0.004751809407025576,
                         0.0007087421254254878, 0.0011090893531218171, 0.0012105685891583562,
                         0.0009092714753933251, 0.0009158219327218831, 0.004193457309156656,
                         0.000523379014339298, 0.0017386494437232614, 0.001680430956184864,
                         0.0010944103123620152, 0.00026818501646630466, 0.001618417794816196,
                         0.0013643662678077817, 0.000751035229768604, 0.0007221907726489007,
                         0.0007345296326093376, 0.0007491005817428231, 0.0007486683898605406,
                         0.001386595075018704, 0.0005392071907408535, 0.0013983980752527714,
                         0.002646318869665265, 0.003030156483873725, 0.0031815955881029367,
                         0.0032887482084333897, 0.0027234244626015425, 0.003691223217174411,
                         0.006377566605806351, 0.001438930630683899, 0.0014632261591032147,
                         0.0015971860848367214, 0.0015796807128936052, 0.0015221928479149938,
                         0.0015456427354365587, 0.0013002513442188501, 0.003683054354041815,
                         0.0039884475991129875, 0.005304807331413031, 0.0014849670697003603,
                         0.000696722767315805, 0.0007429498946294188, 0.0002689434331841767,
                         0.00026548426831141114, 0.0002620834857225418, 0.0006076710997149348,
                         0.0017552450299263, 0.0018421196145936847, 0.0021471839863806963,
                         0.00033170744427479804, 0.008759948424994946, 0.0011945582227781415,
                         0.001372907543554902, 0.0009310372406616807, 0.0005178558640182018,
                         0.0008118049008771777, 0.0009376304224133492, 0.0009215362370014191,
                         0.0009273193427361548, 0.0009536426514387131, 0.0010333311511203647,
                         0.000938196259085089, 0.0034037597943097353, 0.0008554623345844448,
                         0.0008822628878988326, 0.0020648010540753603, 0.0020203825552016497,
                         0.002067198744043708, 0.0021991946268826723, 0.0022167270071804523,
                         0.0014857801143079996, 0.0006280379020608962, 0.0021570269018411636,
                         0.004454676993191242, 0.0045309667475521564, 0.004552657715976238,
                         0.0008922826964408159, 0.004899166524410248, 0.004767373204231262,
                         0.000714978959877044, 0.0010060739004984498, 0.0007014485890977085,
                         0.0014687650837004185, 0.0003075211134273559]
        }
    }
    # excel信息
    excel_path = '历史净值数据_万得指数.xlsx'
    excel_sheet = '历史净值数据'
    # 字典转Json, 模拟输入的Json参数
    json_str = json.dumps(dict_input, ensure_ascii=False)
    print(json_str)

    ''' 1. 解析json参数 & 读取excel数据 --------------------------------------------------------------------------- '''
    (asset_list, draw_plt, draw_plt_filename, user_holding, ef_data,
     returns) = analysis_json_and_read_data(json_str, excel_path, excel_sheet)

    ''' 2) 计算约束 ---------------------------------------------------------------------------------------------- '''
    single_limit, multi_limit = hold_weight_limit_cal(asset_list, user_holding)
    print(f"单层约束: {single_limit}; 多层约束: {multi_limit}")

    ''' 3) 计算推荐组合配置方案 ------------------------------------------------------------------------------------ '''
    ''' 3.1 计算客户当前持仓的风险和收益 '''
    ''' 3.2 计算客户当前持仓同等收益下风险最小的有效前沿上的点 '''
    ''' 3.3 计算客户当前持仓同等风险下收益最大的有效前沿上的点 '''
    ''' 3.4 计算与客户当前持仓换仓最小的有效前沿上的点 '''

    ''' 4) 结果输出为json ------------------------------------------------------------------------------------------ '''

    ''' 工具: 找到json中的有效前沿 '''
    # with open('result_A01_main_api.json', 'r', encoding='utf-8') as f:
    #     result_dict = json.load(f)
    # for k in result_dict['data']['user']:
    #     print(k)
    # ef_mask = np.array(result_dict['data']['user']['ef_mask'])
    # weights = np.array(result_dict['data']['user']['weights'])[ef_mask]
    # ret_annual = np.array(result_dict['data']['user']['ret_annual'])[ef_mask]
    # risk_arr = np.array(result_dict['data']['user']['risk_arr'])[ef_mask]
    # print(len(weights))
    # ll = {'weights': weights.tolist(),
    #       'ret_annual': ret_annual.tolist(),
    #       'risk_arr': risk_arr.tolist()}
    # print(ll)
    # with open('user_ef.json', 'w', encoding='utf-8') as f:
    #     json.dump(ll, f, ensure_ascii=False)
